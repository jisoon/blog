---
title: "Start Project Again"
date: 2017-09-05T23:03:04+09:00
draft: true
tags: [Mockito, TDD]
---

컨트롤러와 서비스는 mockito 를 이용하여 테스트를 한다.

dao 는 @SpringbootTest 를 이용하여 개발 db를 사용하여 테스트를 하였다.

순수 TDD 방식이 아니라다 내가 읽은책(TDD 책) 에 제시한 방법을 사용했다.

그방법은 먼저 요구사항을 분석한후 테스트케이스를 일괄적으로 생성하는 방법인데, 현프로젝트는 요구사항이 화면설계서를 대체하고 있어 화면설계서를 분석하였다.

아래는 분석한후 구현해야될 목록의 테스트 케이스다.
```
코드
```

각 테스트 케이스에 fail(); 명시해서 완료되지 않음을 표시했다.

그다음 API 를 설계를 한다.

API 를 설계를 한다면 Mockito 를 이용해서 서비스클래스 mock 을 이용하여 통과 시킨다.

그다음은 서버스 테스트 클래스를 만들다.
서비스클래스에서는 로직이 필요한 기능 또는 외부연동이 필요한 기능이 없는지 다시 한번 요구사항(화면설계서)를 보면서 파악을 한다.

컨트롤러와 마찬가지로 필요한 dao 는 Mock 클래스로 만들어 통과시킨다.

그다음 Dao 테스트케이스를 만들다.
Dao 테스트는 깨지기 쉬운 테스트 인것 같다. 실질적으로 DB 를 조작해야되는 (이부분은 이일민님이 작성한 블러그 참조해서 추가)
수고가 든다. 복잡도도 높다.

하지만 웹서비스에서 dao 가 가장 큰역활을 하기 때문에 테스트케이스를 작성하지 않는다면 컨트롤러나 서비스의 테스트케이스가 과연 필요할까라는 생각이 든다.

Dao 테스트 케이스를 작성할때는 추가기능을 먼저 작성을 한다.
조회 수정 삭제는 data 가 있는 상태에 가능하기 때문에 추가 기능을 먼저 구현하게 되면 초기값 세팅시 이용할 수 있기 때문이다.

추가 기능도 정말로 잘 추가 되었는지를 확인 하기 위해서는 조회 기능이 필요하지 않을까라고 생각 할 수도 있다. 하지만 insert 후 리턴결과가 1 이라면 정상적으로 insert 되었다고 판단하는것이 덜 복잡한것 같다.

또한 Dao 작성시 연관테이블에 초기값이 필요할 경우가 발생 하는데
이때는 DummyDao 클래스를 따로 구현하였다.
Dao 클래스에 테스트 전용 메소드를 작성하는것 보다 테스트 전용 클래스를 만들어 관리해보니 더 좋은것 같다.






